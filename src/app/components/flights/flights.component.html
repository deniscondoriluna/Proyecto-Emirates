<div class="flights-container">
  <div class="container py-5">
    <!-- Page Header -->
    <div class="page-header text-center mb-5">
      <h1 class="display-4 mb-3">
        <i class="bi bi-airplane-fill me-3"></i>
        Vuelos Disponibles
      </h1>
      <p class="lead text-muted">Encuentra tu próximo destino</p>
    </div>

    <!-- Search/Filter Section -->
    <div class="search-section card shadow-sm mb-5">
      <div class="card-body p-4">
        <h5 class="card-title mb-4">
          <i class="bi bi-search me-2"></i>Buscar Vuelos
        </h5>
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Origen</label>
            <input
              type="text"
              class="form-control"
              placeholder="Ej: Santiago"
              [(ngModel)]="searchOrigin"
              (input)="applyFilters()">
          </div>
          <div class="col-md-4">
            <label class="form-label">Destino</label>
            <input
              type="text"
              class="form-control"
              placeholder="Ej: Dubai"
              [(ngModel)]="searchDestination"
              (input)="applyFilters()">
          </div>
          <div class="col-md-4">
            <label class="form-label">Fecha</label>
            <input
              type="date"
              class="form-control"
              [(ngModel)]="selectedDate"
              (change)="applyFilters()">
          </div>
        </div>
        <div class="mt-3">
          <button class="btn btn-outline-secondary" (click)="clearFilters()">
            <i class="bi bi-x-circle me-2"></i>Limpiar filtros
          </button>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div class="text-center py-5" *ngIf="isLoading">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 text-muted">Cargando vuelos disponibles...</p>
    </div>

    <!-- No Results -->
    <div class="text-center py-5" *ngIf="!isLoading && filteredFlights.length === 0">
      <i class="bi bi-search" style="font-size: 4rem; color: #ccc;"></i>
      <h4 class="mt-4">No se encontraron vuelos</h4>
      <p class="text-muted">Intenta ajustar los filtros de búsqueda</p>
      <button class="btn btn-primary mt-3" (click)="clearFilters()">
        Ver todos los vuelos
      </button>
    </div>

    <!-- Flights Grid -->
    <div class="flights-grid" *ngIf="!isLoading && filteredFlights.length > 0">
      <div class="flight-result-card card shadow-sm mb-4" *ngFor="let flight of filteredFlights">
        <div class="card-body p-4">
          <div class="row align-items-center">
            <!-- Flight Info -->
            <div class="col-lg-8">
              <div class="d-flex justify-content-between align-items-start mb-3">
                <div>
                  <span class="flight-number-badge">{{ flight.flightNumber }}</span>
                  <span class="badge bg-success ms-2">{{ getAvailableSeatsText(flight) }}</span>
                </div>
                <span class="aircraft-badge">
                  <i class="bi bi-airplane"></i> {{ flight.aircraft }}
                </span>
              </div>

              <!-- Route -->
              <div class="flight-route-display mb-3">
                <div class="route-point">
                  <div class="route-time">{{ flight.departureTime }}</div>
                  <div class="route-location">
                    <i class="bi bi-geo-alt-fill text-primary"></i>
                    <strong>{{ flight.origin }}</strong>
                  </div>
                </div>

                <div class="route-connection">
                  <div class="route-line"></div>
                  <div class="route-duration">
                    <i class="bi bi-clock"></i>
                    {{ flight.duration }}
                  </div>
                  <div class="route-line"></div>
                </div>

                <div class="route-point text-end">
                  <div class="route-time">{{ flight.arrivalTime }}</div>
                  <div class="route-location">
                    <strong>{{ flight.destination }}</strong>
                    <i class="bi bi-geo-alt-fill text-danger"></i>
                  </div>
                </div>
              </div>

              <!-- Flight Details -->
              <div class="flight-details-row">
                <div class="detail-item">
                  <i class="bi bi-calendar3"></i>
                  <span>{{ formatDate(flight.departureDate) }}</span>
                </div>
                <div class="detail-item">
                  <i class="bi bi-star-fill text-warning"></i>
                  <span>{{ flight.status }}</span>
                </div>
              </div>

              <!-- Amenities -->
              <div class="amenities-list mt-3">
                <span class="amenity-tag" *ngFor="let amenity of flight.amenities.slice(0, 3)">
                  <i class="bi bi-check-circle-fill"></i> {{ amenity }}
                </span>
              </div>
            </div>

            <!-- Pricing & Booking -->
            <div class="col-lg-4 mt-4 mt-lg-0">
              <div class="pricing-section">
                <div class="price-class mb-2">
                  <span class="class-label">Económica</span>
                  <span class="class-price">{{ formatPrice(flight.pricing.economy) }}</span>
                </div>
                <div class="price-class mb-2">
                  <span class="class-label">Business</span>
                  <span class="class-price">{{ formatPrice(flight.pricing.business) }}</span>
                </div>
                <div class="price-class mb-3">
                  <span class="class-label">Primera Clase</span>
                  <span class="class-price">{{ formatPrice(flight.pricing.firstClass) }}</span>
                </div>

                <button
                  class="btn btn-primary w-100 btn-lg"
                  (click)="selectFlightForBooking(flight)">
                  <i class="bi bi-ticket-perforated-fill me-2"></i>
                  Reservar Ahora
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Results Summary -->
    <div class="results-summary text-center mt-4" *ngIf="!isLoading && filteredFlights.length > 0">
      <p class="text-muted">
        Mostrando {{ filteredFlights.length }} de {{ flights.length }} vuelo(s) disponible(s)
      </p>
    </div>
  </div>
</div>
